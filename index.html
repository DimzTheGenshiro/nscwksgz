<html lang="id">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1" name="viewport"/>
  <title>
   Website Produk Digital
  </title>
  <script src="https://cdn.tailwindcss.com">
  </script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&amp;display=swap" rel="stylesheet"/>
  <style>
   body {
      font-family: 'Inter', sans-serif;
    }
  </style>
 </head>
 <body class="bg-gray-50 min-h-screen flex flex-col">
  <header class="bg-white shadow-md sticky top-0 z-50">
   <nav class="container mx-auto px-4 py-4 flex justify-between items-center">
    <a class="text-2xl font-bold text-indigo-600" href="#dashboard">
     DigitalStore
    </a>
    <ul class="hidden md:flex space-x-8 text-gray-700 font-semibold">
     <li>
      <a class="hover:text-indigo-600" href="#dashboard">
       Dashboard
      </a>
     </li>
     <li>
      <a class="hover:text-indigo-600" href="#products">
       Produk
      </a>
     </li>
     <li>
      <a class="hover:text-indigo-600" href="#order-status">
       Status Pesanan
      </a>
     </li>
    </ul>
    <button class="md:hidden text-gray-700 focus:outline-none" id="mobile-menu-button">
     <i class="fas fa-bars fa-lg">
     </i>
    </button>
   </nav>
   <div class="hidden md:hidden bg-white shadow-md" id="mobile-menu">
    <ul class="flex flex-col p-4 space-y-3 text-gray-700 font-semibold">
     <li>
      <a class="hover:text-indigo-600" href="#dashboard">
       Dashboard
      </a>
     </li>
     <li>
      <a class="hover:text-indigo-600" href="#products">
       Produk
      </a>
     </li>
     <li>
      <a class="hover:text-indigo-600" href="#order-status">
       Status Pesanan
      </a>
     </li>
    </ul>
   </div>
  </header>
  <main class="flex-grow container mx-auto px-4 py-8">
   <!-- Dashboard Section -->
   <section class="mb-16" id="dashboard">
    <h2 class="text-3xl font-bold text-gray-800 mb-6">
     Dashboard
    </h2>
    <!-- Slideshow -->
    <div class="relative w-full max-w-4xl mx-auto mb-12">
     <div class="overflow-hidden rounded-lg shadow-lg" id="slideshow">
      <img alt="Banner promo website terbaru dengan desain modern dan warna biru" class="w-full h-64 object-cover" height="400" src="https://storage.googleapis.com/a1aa/image/4d125ae4-3313-4ee4-3ee1-c52babee6e0d.jpg" width="1200"/>
     </div>
     <button aria-label="Previous Slide" class="absolute top-1/2 left-4 -translate-y-1/2 bg-indigo-600 text-white rounded-full p-2 shadow hover:bg-indigo-700 focus:outline-none" id="prevSlide">
      <i class="fas fa-chevron-left">
      </i>
     </button>
     <button aria-label="Next Slide" class="absolute top-1/2 right-4 -translate-y-1/2 bg-indigo-600 text-white rounded-full p-2 shadow hover:bg-indigo-700 focus:outline-none" id="nextSlide">
      <i class="fas fa-chevron-right">
      </i>
     </button>
    </div>
    <!-- Kategori Produk -->
    <div class="max-w-4xl mx-auto grid grid-cols-2 gap-8 text-center">
     <a class="category-card cursor-pointer bg-white rounded-lg shadow-md p-8 hover:shadow-lg transition-shadow" data-category="Website" href="#products">
      <i class="fas fa-globe fa-4x text-indigo-600 mb-4">
      </i>
      <h3 class="text-xl font-semibold text-gray-800">
       Website
      </h3>
     </a>
     <a class="category-card cursor-pointer bg-white rounded-lg shadow-md p-8 hover:shadow-lg transition-shadow" data-category="Script" href="#products">
      <i class="fas fa-code fa-4x text-indigo-600 mb-4">
      </i>
      <h3 class="text-xl font-semibold text-gray-800">
       Script
      </h3>
     </a>
    </div>
   </section>
   <!-- Produk Section -->
   <section class="mb-16" id="products">
    <h2 class="text-3xl font-bold text-gray-800 mb-6">
     Produk
    </h2>
    <!-- Filter Kategori -->
    <div class="max-w-4xl mx-auto mb-6 flex flex-wrap gap-4">
     <button class="filter-btn bg-indigo-600 text-white px-4 py-2 rounded-md font-semibold hover:bg-indigo-700 focus:outline-none" data-filter="all">
      Semua
     </button>
     <button class="filter-btn bg-gray-200 text-gray-700 px-4 py-2 rounded-md font-semibold hover:bg-indigo-600 hover:text-white focus:outline-none" data-filter="Website">
      Website
     </button>
     <button class="filter-btn bg-gray-200 text-gray-700 px-4 py-2 rounded-md font-semibold hover:bg-indigo-600 hover:text-white focus:outline-none" data-filter="Script">
      Script
     </button>
    </div>
    <!-- Daftar Produk -->
    <div class="max-w-6xl mx-auto grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-8" id="product-list">
     <!-- Product 1 -->
     <div class="product-card bg-white rounded-lg shadow-md p-4 flex flex-col" data-category="Website">
      <img alt="Thumbnail website portofolio dengan desain minimalis dan profesional" class="rounded-md mb-4 object-cover h-48 w-full" height="250" src="https://storage.googleapis.com/a1aa/image/d8ac70ad-691a-4990-b2c3-3f93b4db99bb.jpg" width="400"/>
      <h3 class="text-lg font-semibold text-gray-800 mb-2">
       Website Portofolio
      </h3>
      <p class="text-gray-600 flex-grow">
       Website portofolio modern untuk menampilkan karya dan profil profesional Anda.
      </p>
      <div class="mt-4 flex items-center justify-between">
       <span class="text-indigo-600 font-bold text-lg">
        Rp 1.200.000
       </span>
       <button class="buy-btn bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 focus:outline-none" data-id="1">
        Beli
       </button>
      </div>
     </div>
     <!-- Product 2 -->
     <div class="product-card bg-white rounded-lg shadow-md p-4 flex flex-col" data-category="Website">
      <img alt="Thumbnail website toko online dengan tampilan modern dan user friendly" class="rounded-md mb-4 object-cover h-48 w-full" height="250" src="https://storage.googleapis.com/a1aa/image/de8510f2-66f2-40f1-8222-cceeeac2f199.jpg" width="400"/>
      <h3 class="text-lg font-semibold text-gray-800 mb-2">
       Website Toko Online
      </h3>
      <p class="text-gray-600 flex-grow">
       Website toko online lengkap dengan fitur pembayaran dan manajemen produk.
      </p>
      <div class="mt-4 flex items-center justify-between">
       <span class="text-indigo-600 font-bold text-lg">
        Rp 2.500.000
       </span>
       <button class="buy-btn bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 focus:outline-none" data-id="2">
        Beli
       </button>
      </div>
     </div>
     <!-- Product 3 -->
     <div class="product-card bg-white rounded-lg shadow-md p-4 flex flex-col" data-category="Script">
      <img alt="Thumbnail script login PHP dengan keamanan tinggi dan dokumentasi lengkap" class="rounded-md mb-4 object-cover h-48 w-full" height="250" src="https://storage.googleapis.com/a1aa/image/02be6e69-e34a-4f88-8ee9-100f69f9ba0a.jpg" width="400"/>
      <h3 class="text-lg font-semibold text-gray-800 mb-2">
       Script Login PHP
      </h3>
      <p class="text-gray-600 flex-grow">
       Script login PHP dengan fitur keamanan dan validasi lengkap untuk website Anda.
      </p>
      <div class="mt-4 flex items-center justify-between">
       <span class="text-indigo-600 font-bold text-lg">
        Rp 350.000
       </span>
       <button class="buy-btn bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 focus:outline-none" data-id="3">
        Beli
       </button>
      </div>
     </div>
     <!-- Product 4 -->
     <div class="product-card bg-white rounded-lg shadow-md p-4 flex flex-col" data-category="Script">
      <img alt="Thumbnail script API REST dengan dokumentasi lengkap dan contoh penggunaan" class="rounded-md mb-4 object-cover h-48 w-full" height="250" src="https://storage.googleapis.com/a1aa/image/504d0f70-5b36-468f-5607-c1c66cbcd5ae.jpg" width="400"/>
      <h3 class="text-lg font-semibold text-gray-800 mb-2">
       Script API REST
      </h3>
      <p class="text-gray-600 flex-grow">
       Script API REST siap pakai untuk integrasi aplikasi dengan dokumentasi lengkap.
      </p>
      <div class="mt-4 flex items-center justify-between">
       <span class="text-indigo-600 font-bold text-lg">
        Rp 450.000
       </span>
       <button class="buy-btn bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 focus:outline-none" data-id="4">
        Beli
       </button>
      </div>
     </div>
     <!-- Product 5 -->
     <div class="product-card bg-white rounded-lg shadow-md p-4 flex flex-col" data-category="Website">
      <img alt="Thumbnail website blog dengan desain responsif dan fitur komentar" class="rounded-md mb-4 object-cover h-48 w-full" height="250" src="https://storage.googleapis.com/a1aa/image/0ae27845-31d5-400f-18ea-d265b809a94b.jpg" width="400"/>
      <h3 class="text-lg font-semibold text-gray-800 mb-2">
       Website Blog
      </h3>
      <p class="text-gray-600 flex-grow">
       Website blog dengan desain responsif dan fitur komentar untuk interaksi pembaca.
      </p>
      <div class="mt-4 flex items-center justify-between">
       <span class="text-indigo-600 font-bold text-lg">
        Rp 1.000.000
       </span>
       <button class="buy-btn bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 focus:outline-none" data-id="5">
        Beli
       </button>
      </div>
     </div>
     <!-- Product 6 -->
     <div class="product-card bg-white rounded-lg shadow-md p-4 flex flex-col" data-category="Script">
      <img alt="Thumbnail script chatbot AI dengan fitur interaktif dan mudah dikustomisasi" class="rounded-md mb-4 object-cover h-48 w-full" height="250" src="https://storage.googleapis.com/a1aa/image/7844a9b6-b4fa-4aff-9fc0-1f4e02000357.jpg" width="400"/>
      <h3 class="text-lg font-semibold text-gray-800 mb-2">
       Script Chatbot AI
      </h3>
      <p class="text-gray-600 flex-grow">
       Script chatbot AI interaktif yang mudah dikustomisasi untuk website dan aplikasi.
      </p>
      <div class="mt-4 flex items-center justify-between">
       <span class="text-indigo-600 font-bold text-lg">
        Rp 600.000
       </span>
       <button class="buy-btn bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 focus:outline-none" data-id="6">
        Beli
       </button>
      </div>
     </div>
    </div>
   </section>
   <!-- Detail Produk Section -->
   <section class="mb-16 max-w-4xl mx-auto hidden bg-white rounded-lg shadow-md p-6" id="product-detail">
    <button class="mb-6 text-indigo-600 font-semibold hover:underline focus:outline-none" id="back-to-products">
     ← Kembali ke Produk
    </button>
    <div class="flex flex-col md:flex-row gap-6">
     <img alt="" class="rounded-lg w-full md:w-1/2 object-cover max-h-96" id="detail-image" src=""/>
     <div class="flex flex-col justify-between w-full md:w-1/2">
      <div>
       <h3 class="text-2xl font-bold text-gray-800 mb-4" id="detail-title">
       </h3>
       <p class="text-gray-700 mb-6" id="detail-description">
       </p>
      </div>
      <div class="flex items-center justify-between">
       <span class="text-indigo-600 font-bold text-2xl" id="detail-price">
       </span>
       <button class="bg-indigo-600 text-white px-6 py-3 rounded-md hover:bg-indigo-700 focus:outline-none" id="detail-buy-btn">
        Beli
       </button>
      </div>
     </div>
    </div>
   </section>
   <!-- Pembayaran Section -->
   <section class="max-w-4xl mx-auto hidden bg-white rounded-lg shadow-md p-6" id="payment">
    <button class="mb-6 text-indigo-600 font-semibold hover:underline focus:outline-none" id="back-to-detail">
     ← Kembali ke Detail Produk
    </button>
    <h2 class="text-3xl font-bold text-gray-800 mb-6">
     Pembayaran
    </h2>
    <div class="mb-6">
     <p class="text-gray-700 mb-2">
      Produk:
      <span class="font-semibold" id="payment-product-name">
      </span>
     </p>
     <p class="text-gray-700 mb-2">
      Harga:
      <span class="font-semibold text-indigo-600" id="payment-product-price">
      </span>
     </p>
    </div>
    <div class="mb-6" id="paypal-button-container">
    </div>
    <div class="text-center text-green-600 font-semibold hidden" id="payment-message">
    </div>
   </section>
   <!-- Status Pesanan Section -->
   <section class="max-w-4xl mx-auto mb-16" id="order-status">
    <h2 class="text-3xl font-bold text-gray-800 mb-6">
     Status Pesanan
    </h2>
    <div class="bg-white rounded-lg shadow-md p-6" id="orders-container">
     <table class="w-full text-left border-collapse">
      <thead>
       <tr class="border-b border-gray-300">
        <th class="py-3 px-4 font-semibold text-gray-700">
         Order ID
        </th>
        <th class="py-3 px-4 font-semibold text-gray-700">
         Item
        </th>
        <th class="py-3 px-4 font-semibold text-gray-700">
         Price
        </th>
        <th class="py-3 px-4 font-semibold text-gray-700">
         Status
        </th>
        <th class="py-3 px-4 font-semibold text-gray-700">
         Aksi
        </th>
       </tr>
      </thead>
      <tbody class="divide-y divide-gray-200" id="orders-list">
      </tbody>
     </table>
     <p class="text-center text-gray-500 mt-6 hidden" id="no-orders">
      Belum ada pesanan.
     </p>
    </div>
   </section>
  </main>
  <footer class="bg-white border-t border-gray-200 py-6 text-center text-gray-600 text-sm">
   © 2024 DigitalStore. All rights reserved.
  </footer>
  <script src="https://www.paypal.com/sdk/js?client-id=Ae2UJcfqNOymRYYKMYnE17sXEXBaW8tJF_NZ3M5huk1DREqaMHG_53DcgtePpGv-KXvSBNPxkTfJzboY¤cy=IDR">
  </script>
  <script>
   // Mobile menu toggle
    const mobileMenuBtn = document.getElementById('mobile-menu-button');
    const mobileMenu = document.getElementById('mobile-menu');
    mobileMenuBtn.addEventListener('click', () => {
      mobileMenu.classList.toggle('hidden');
    });

    // Slideshow logic
    const slides = [
      {
        src: 'https://placehold.co/1200x400/png?text=Promo+Website+Terbaru',
        alt: 'Banner promo website terbaru dengan desain modern dan warna biru',
      },
      {
        src: 'https://placehold.co/1200x400/png?text=Diskon+Script+Chatbot+AI',
        alt: 'Banner diskon script chatbot AI dengan ilustrasi robot dan warna ungu',
      },
      {
        src: 'https://placehold.co/1200x400/png?text=Promo+Website+Toko+Online',
        alt: 'Banner promo website toko online dengan tampilan modern dan warna hijau',
      },
    ];
    let currentSlide = 0;
    const slideshowImg = document.querySelector('#slideshow img');
    const prevSlideBtn = document.getElementById('prevSlide');
    const nextSlideBtn = document.getElementById('nextSlide');

    function showSlide(index) {
      if (index < 0) index = slides.length - 1;
      if (index >= slides.length) index = 0;
      currentSlide = index;
      slideshowImg.src = slides[index].src;
      slideshowImg.alt = slides[index].alt;
    }
    prevSlideBtn.addEventListener('click', () => {
      showSlide(currentSlide - 1);
    });
    nextSlideBtn.addEventListener('click', () => {
      showSlide(currentSlide + 1);
    });
    // Auto slide every 5 seconds
    setInterval(() => {
      showSlide(currentSlide + 1);
    }, 5000);

    showSlide(0);

    // Product data
    const products = [
      {
        id: '1',
        category: 'Website',
        title: 'Website Portofolio',
        description:
          'Website portofolio modern untuk menampilkan karya dan profil profesional Anda.',
        price: 1200000,
        image:
          'https://placehold.co/400x250/png?text=Website+Portofolio',
        downloadLink: 'https://example.com/download/website-portofolio.zip',
      },
      {
        id: '2',
        category: 'Website',
        title: 'Website Toko Online',
        description:
          'Website toko online lengkap dengan fitur pembayaran dan manajemen produk.',
        price: 2500000,
        image:
          'https://placehold.co/400x250/png?text=Website+Toko+Online',
        downloadLink: 'https://example.com/download/website-toko-online.zip',
      },
      {
        id: '3',
        category: 'Script',
        title: 'Script Login PHP',
        description:
          'Script login PHP dengan fitur keamanan dan validasi lengkap untuk website Anda.',
        price: 350000,
        image:
          'https://placehold.co/400x250/png?text=Script+Login+PHP',
        downloadLink: 'https://example.com/download/script-login-php.zip',
      },
      {
        id: '4',
        category: 'Script',
        title: 'Script API REST',
        description:
          'Script API REST siap pakai untuk integrasi aplikasi dengan dokumentasi lengkap.',
        price: 450000,
        image:
          'https://placehold.co/400x250/png?text=Script+API+Rest',
        downloadLink: 'https://example.com/download/script-api-rest.zip',
      },
      {
        id: '5',
        category: 'Website',
        title: 'Website Blog',
        description:
          'Website blog dengan desain responsif dan fitur komentar untuk interaksi pembaca.',
        price: 1000000,
        image:
          'https://placehold.co/400x250/png?text=Website+Blog',
        downloadLink: 'https://example.com/download/website-blog.zip',
      },
      {
        id: '6',
        category: 'Script',
        title: 'Script Chatbot AI',
        description:
          'Script chatbot AI interaktif yang mudah dikustomisasi untuk website dan aplikasi.',
        price: 600000,
        image:
          'https://placehold.co/400x250/png?text=Script+Chatbot',
        downloadLink: 'https://example.com/download/script-chatbot-ai.zip',
      },
    ];

    // Filter products
    const filterButtons = document.querySelectorAll('.filter-btn');
    const productCards = document.querySelectorAll('.product-card');
    filterButtons.forEach((btn) => {
      btn.addEventListener('click', () => {
        filterButtons.forEach((b) => {
          b.classList.remove('bg-indigo-600', 'text-white');
          b.classList.add('bg-gray-200', 'text-gray-700');
        });
        btn.classList.add('bg-indigo-600', 'text-white');
        btn.classList.remove('bg-gray-200', 'text-gray-700');

        const filter = btn.getAttribute('data-filter');
        productCards.forEach((card) => {
          if (filter === 'all' || card.dataset.category === filter) {
            card.classList.remove('hidden');
          } else {
            card.classList.add('hidden');
          }
        });
      });
    });

    // Category cards click to filter and scroll to products
    const categoryCards = document.querySelectorAll('.category-card');
    categoryCards.forEach((card) => {
      card.addEventListener('click', (e) => {
        e.preventDefault();
        const category = card.getAttribute('data-category');
        filterButtons.forEach((b) => {
          b.classList.remove('bg-indigo-600', 'text-white');
          b.classList.add('bg-gray-200', 'text-gray-700');
          if (b.getAttribute('data-filter') === category) {
            b.classList.add('bg-indigo-600', 'text-white');
            b.classList.remove('bg-gray-200', 'text-gray-700');
          }
        });
        productCards.forEach((card) => {
          if (card.dataset.category === category) {
            card.classList.remove('hidden');
          } else {
            card.classList.add('hidden');
          }
        });
        document.getElementById('products').scrollIntoView({ behavior: 'smooth' });
      });
    });

    // Show product detail
    const productList = document.getElementById('product-list');
    const productDetailSection = document.getElementById('product-detail');
    const dashboardSection = document.getElementById('dashboard');
    const productsSection = document.getElementById('products');
    const paymentSection = document.getElementById('payment');
    const orderStatusSection = document.getElementById('order-status');

    const detailImage = document.getElementById('detail-image');
    const detailTitle = document.getElementById('detail-title');
    const detailDescription = document.getElementById('detail-description');
    const detailPrice = document.getElementById('detail-price');
    const detailBuyBtn = document.getElementById('detail-buy-btn');

    let selectedProduct = null;

    productList.addEventListener('click', (e) => {
      if (e.target.classList.contains('buy-btn')) {
        const id = e.target.getAttribute('data-id');
        openProductDetail(id);
      }
    });

    function openProductDetail(id) {
      selectedProduct = products.find((p) => p.id === id);
      if (!selectedProduct) return;
      detailImage.src = selectedProduct.image;
      detailImage.alt = `Gambar produk ${selectedProduct.title} dengan kategori ${selectedProduct.category}`;
      detailTitle.textContent = selectedProduct.title;
      detailDescription.textContent = selectedProduct.description;
      detailPrice.textContent = formatRupiah(selectedProduct.price);
      productDetailSection.classList.remove('hidden');
      dashboardSection.classList.add('hidden');
      productsSection.classList.add('hidden');
      paymentSection.classList.add('hidden');
      orderStatusSection.classList.add('hidden');
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    document.getElementById('back-to-products').addEventListener('click', () => {
      productDetailSection.classList.add('hidden');
      dashboardSection.classList.add('hidden');
      productsSection.classList.remove('hidden');
      paymentSection.classList.add('hidden');
      orderStatusSection.classList.add('hidden');
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });

    // Format Rupiah
    function formatRupiah(number) {
      return new Intl.NumberFormat('id-ID', {
        style: 'currency',
        currency: 'IDR',
        minimumFractionDigits: 0,
      }).format(number);
    }

    // Payment process
    const paymentProductName = document.getElementById('payment-product-name');
    const paymentProductPrice = document.getElementById('payment-product-price');
    const paypalContainer = document.getElementById('paypal-button-container');
    const paymentMessage = document.getElementById('payment-message');
    const backToDetailBtn = document.getElementById('back-to-detail');

    detailBuyBtn.addEventListener('click', () => {
      if (!selectedProduct) return;
      openPayment(selectedProduct);
    });

    backToDetailBtn.addEventListener('click', () => {
      paymentSection.classList.add('hidden');
      productDetailSection.classList.remove('hidden');
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });

    function openPayment(product) {
      paymentProductName.textContent = product.title;
      paymentProductPrice.textContent = formatRupiah(product.price);
      paymentMessage.classList.add('hidden');
      paymentMessage.textContent = '';
      productDetailSection.classList.add('hidden');
      paymentSection.classList.remove('hidden');
      dashboardSection.classList.add('hidden');
      productsSection.classList.add('hidden');
      orderStatusSection.classList.add('hidden');
      window.scrollTo({ top: 0, behavior: 'smooth' });

      // Render PayPal button
      paypalContainer.innerHTML = '';
      paypal.Buttons({
        style: {
          layout: 'vertical',
          color: 'blue',
          shape: 'rect',
          label: 'pay',
        },
        createOrder: function (data, actions) {
          return actions.order.create({
            purchase_units: [
              {
                description: product.title,
                amount: {
                  currency_code: 'IDR',
                  value: (product.price / 1000).toFixed(3), // PayPal IDR expects decimal, convert Rp to thousands
                },
              },
            ],
          });
        },
        onApprove: function (data, actions) {
          return actions.order.capture().then(function (details) {
            // Save order to localStorage
            const orderId = data.orderID;
            const order = {
              orderId,
              item: product.title,
              price: product.price,
              status: 'Success',
              downloadLink: product.downloadLink,
            };
            saveOrder(order);
            paymentMessage.textContent = 'Pembayaran berhasil! Terima kasih atas pembelian Anda.';
            paymentMessage.classList.remove('hidden');
            setTimeout(() => {
              openOrderStatus();
            }, 2000);
          });
        },
        onCancel: function () {
          paymentMessage.textContent = 'Pembayaran dibatalkan.';
          paymentMessage.classList.remove('hidden');
        },
        onError: function (err) {
          paymentMessage.textContent = 'Terjadi kesalahan saat pembayaran. Silakan coba lagi.';
          paymentMessage.classList.remove('hidden');
          console.error(err);
        },
      }).render('#paypal-button-container');
    }

    // Orders management in localStorage
    function saveOrder(order) {
      let orders = JSON.parse(localStorage.getItem('orders')) || [];
      orders.push(order);
      localStorage.setItem('orders', JSON.stringify(orders));
    }

    function getOrders() {
      return JSON.parse(localStorage.getItem('orders')) || [];
    }

    // Show order status
    const ordersList = document.getElementById('orders-list');
    const noOrdersText = document.getElementById('no-orders');

    function openOrderStatus() {
      dashboardSection.classList.add('hidden');
      productsSection.classList.add('hidden');
      productDetailSection.classList.add('hidden');
      paymentSection.classList.add('hidden');
      orderStatusSection.classList.remove('hidden');
      window.scrollTo({ top: 0, behavior: 'smooth' });
      renderOrders();
    }

    function renderOrders() {
      const orders = getOrders();
      ordersList.innerHTML = '';
      if (orders.length === 0) {
        noOrdersText.classList.remove('hidden');
        return;
      } else {
        noOrdersText.classList.add('hidden');
      }
      orders.forEach((order, index) => {
        const tr = document.createElement('tr');
        tr.classList.add('border-b', 'border-gray-200');
        tr.innerHTML = `
          <td class="py-3 px-4">${order.orderId}</td>
          <td class="py-3 px-4">${order.item}</td>
          <td class="py-3 px-4">${formatRupiah(order.price)}</td>
          <td class="py-3 px-4 font-semibold ${
            order.status === 'Success' ? 'text-green-600' : 'text-yellow-600'
          }">${order.status}</td>
          <td class="py-3 px-4">
            ${
              order.status === 'Pending'
                ? `<button class="pay-again-btn bg-indigo-600 text-white px-3 py-1 rounded-md hover:bg-indigo-700 focus:outline-none" data-index="${index}">Bayar</button>`
                : `<a href="${order.downloadLink}" target="_blank" rel="noopener" class="download-btn bg-green-600 text-white px-3 py-1 rounded-md hover:bg-green-700 focus:outline-none">Klik untuk Unduh</a>`
            }
          </td>
        `;
        ordersList.appendChild(tr);
      });

      // Attach event listeners for pay again buttons
      const payAgainButtons = document.querySelectorAll('.pay-again-btn');
      payAgainButtons.forEach((btn) => {
        btn.addEventListener('click', () => {
          const idx = btn.getAttribute('data-index');
          payPendingOrder(idx);
        });
      });
    }

    // Pay pending order
    function payPendingOrder(index) {
      const orders = getOrders();
      const order = orders[index];
      if (!order) return;
      // Find product by title
      const product = products.find((p) => p.title === order.item);
      if (!product) return alert('Produk tidak ditemukan.');

      selectedProduct = product;
      openPayment(product);

      // Override onApprove to update order status
      paypal.Buttons({
        style: {
          layout: 'vertical',
          color: 'blue',
          shape: 'rect',
          label: 'pay',
        },
        createOrder: function (data, actions) {
          return actions.order.create({
            purchase_units: [
              {
                description: product.title,
                amount: {
                  currency_code: 'IDR',
                  value: (product.price / 1000).toFixed(3),
                },
              },
            ],
          });
        },
        onApprove: function (data, actions) {
          return actions.order.capture().then(function (details) {
            orders[index].status = 'Success';
            localStorage.setItem('orders', JSON.stringify(orders));
            paymentMessage.textContent = 'Pembayaran berhasil! Terima kasih atas pembelian Anda.';
            paymentMessage.classList.remove('hidden');
            setTimeout(() => {
              openOrderStatus();
            }, 2000);
          });
        },
        onCancel: function () {
          paymentMessage.textContent = 'Pembayaran dibatalkan.';
          paymentMessage.classList.remove('hidden');
        },
        onError: function (err) {
          paymentMessage.textContent = 'Terjadi kesalahan saat pembayaran. Silakan coba lagi.';
          paymentMessage.classList.remove('hidden');
          console.error(err);
        },
      }).render('#paypal-button-container');
    }

    // Navigation anchors smooth scroll
    document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
          target.scrollIntoView({ behavior: 'smooth' });
        }
      });
    });

    // On page load, show dashboard and products, hide others
    function init() {
      dashboardSection.classList.remove('hidden');
      productsSection.classList.remove('hidden');
      productDetailSection.classList.add('hidden');
      paymentSection.classList.add('hidden');
      orderStatusSection.classList.add('hidden');
    }
    init();
  </script>
 </body>
</html>
